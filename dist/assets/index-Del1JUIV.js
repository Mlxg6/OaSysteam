import{r as c,o as x,c as S,b as e,w as o,g as j,e as V,G as z,H as M,u as q,Y as F,d as E,j as w,V as L}from"./index-CPZCLJhI.js";import{_ as P,E as R,a as G,b as H,c as Y,v as J}from"./el-table-column-Cw6mIs8X.js";import{E as K}from"./el-input-EJwEnXI7.js";import"./el-popper-CBzjx_xb.js";import{E as h}from"./el-button-aGybSvRj.js";import{t as O,v as Q}from"./_plugin-vue_export-helper-C52UWfAG.js";import{a as k,b as W,g as X,c as Z}from"./announcement-CeJ6vcum.js";import{E as ee}from"./el-dialog-DrTM45KF.js";import"./el-overlay-DNljXtA7.js";import{E as te,a as ae}from"./el-form-item-CvQ51XjY.js";import{E as T}from"./request-Bo9Nm4OM.js";import{E as ne}from"./el-message-box-JObjlNit.js";import"./_initCloneObject-CWwr7yUn.js";const oe={class:"dialog-footer"},le={__name:"ChannelEdit",emits:["success"],setup(B,{expose:v,emit:b}){const t=c({title:"",content:""}),i={title:[{required:!0,message:"请输入公告标题",trigger:"blur"}],content:[{required:!0,message:"请输入公告内容",trigger:"blur"}]},u=c(!1);v({open:r=>{u.value=!0,t.value={...r}}});const d=b,y=c(),C=async()=>{await y.value.validate();const r=t.value.id;console.log("id",r),console.log(t.value),await k(t.value),r?await k(t.value):await W(t.value),d("success"),T({type:"success",message:r?"编辑成功":"添加成功"}),u.value=!1};return(r,l)=>{const g=K,_=te,a=ae,s=h,f=ee;return x(),S("div",null,[e(f,{modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=n=>u.value=n),title:t.value.id?"编辑公告":"添加公告",width:"50%"},{footer:o(()=>[j("div",oe,[e(s,{onClick:l[3]||(l[3]=n=>u.value=!1)},{default:o(()=>[V("取消")]),_:1}),e(s,{type:"primary",onClick:C},{default:o(()=>[V("确认")]),_:1})])]),default:o(()=>[e(a,{model:t.value,rules:i,"label-width":"100px",style:{"padding-right":"30px"},ref_key:"formRef",ref:y},{default:o(()=>[e(_,{label:"标题",prop:"title"},{default:o(()=>[e(g,{modelValue:t.value.title,"onUpdate:modelValue":l[0]||(l[0]=n=>t.value.title=n),minlength:"1",maxlength:"10"},null,8,["modelValue"])]),_:1}),e(_,{label:"内容",prop:"content"},{default:o(()=>[e(g,{modelValue:t.value.content,"onUpdate:modelValue":l[1]||(l[1]=n=>t.value.content=n),minlength:"1",maxlength:"20"},null,8,["modelValue"])]),_:1}),z(e(_,{label:"时间",prop:"createTime"},{default:o(()=>[e(g,{modelValue:t.value.createTime,"onUpdate:modelValue":l[2]||(l[2]=n=>t.value.createTime=n)},null,8,["modelValue"])]),_:1},512),[[M,t.value.id]])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye={__name:"index",setup(B){const v=q(),b=c([]),t=c(0),i=c({pageNumber:1,pageSize:5}),u=c(!1),p=async()=>{u.value=!0;const{data:a}=await X(i.value);b.value=a.records,t.value=a.total,u.value=!1};p();const d=c(),y=()=>{d.value.open({})},C=(a,s)=>{console.log(a,s),d.value.open(a)},r=async(a,s)=>{console.log(a,s),await ne.confirm("你确认删除该分类信息吗？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),await Z(a.id),T({type:"success",message:"删除成功"}),p()},l=a=>{console.log(a),p()},g=a=>{i.value.pageNumber=1,i.value.pageSize=a,p()},_=()=>{p()};return(a,s)=>{const f=h,n=R,N=G,U=H,A=Y,D=P,$=J;return x(),S("div",null,[e(D,{title:"通知公告"},F({default:o(()=>[z((x(),w(U,{data:b.value,style:{width:"100%"}},{empty:o(()=>[e(N,{description:"没有数据"})]),default:o(()=>[e(n,{prop:"id",label:"ID",width:"60"}),e(n,{prop:"title",label:"标题"}),e(n,{prop:"content",label:"内容"}),e(n,{prop:"createTime",label:"时间"}),E(v).user.username==="admin"?(x(),w(n,{key:0,label:"操作",width:"150"},{default:o(m=>[e(f,{icon:E(O),circle:"",plain:"",type:"primary",onClick:I=>C(m.row,m.$index)},null,8,["icon","onClick"]),e(f,{icon:E(Q),circle:"",plain:"",type:"danger",onClick:I=>r(m.row,m.$index)},null,8,["icon","onClick"])]),_:1})):L("",!0)]),_:1},8,["data"])),[[$,u.value]]),e(A,{"current-page":i.value.pageNumber,"onUpdate:currentPage":s[0]||(s[0]=m=>i.value.pageNumber=m),"page-size":i.value.pageSize,"onUpdate:pageSize":s[1]||(s[1]=m=>i.value.pageSize=m),"page-sizes":[2,3,4,5,10],layout:"jumper, total, sizes, prev, pager, next",background:"",total:t.value,onSizeChange:g,onCurrentChange:_,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:2},[E(v).user.username==="admin"?{name:"extra",fn:o(()=>[e(f,{type:"primary",onClick:y},{default:o(()=>[V(" 新增公告 ")]),_:1})]),key:"0"}:void 0]),1024),e(le,{ref_key:"dialog",ref:d,onSuccess:l},null,512)])}}};export{ye as default};
