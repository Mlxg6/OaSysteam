import{r as d,o as v,c as S,b as e,w as o,g as T,e as h,u as j,d as k,j as w,V as C,G as I}from"./index-CPZCLJhI.js";import{_ as M,E as F,a as P,b as R,c as G,v as H}from"./el-table-column-Cw6mIs8X.js";import{E as J}from"./el-input-EJwEnXI7.js";import"./el-popper-CBzjx_xb.js";import{E as z}from"./el-button-aGybSvRj.js";import{t as K,v as O}from"./_plugin-vue_export-helper-C52UWfAG.js";import{i as N,E as U}from"./request-Bo9Nm4OM.js";import{E as Q}from"./el-dialog-DrTM45KF.js";import"./el-overlay-DNljXtA7.js";import{E as W,a as X}from"./el-form-item-CvQ51XjY.js";import{E as Y}from"./el-message-box-JObjlNit.js";import"./_initCloneObject-CWwr7yUn.js";const Z=c=>N({url:"contact/page",method:"get",params:c}),ee=c=>N({url:"contact/save",method:"post",data:c}),ae=c=>N.delete("/contact/delete/+".concat(c)),le={class:"dialog-footer"},te={__name:"ChannelEdit",emits:["success"],setup(c,{expose:f,emit:V}){const l=d({nickname:"",phone:"",email:"",companyName:"",position:"",workingAddress:""}),r={nickname:[{required:!0,message:"请输入用户昵称",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],email:[{required:!0,message:"请输入电子邮箱",trigger:"blur"}],companyName:[{required:!0,message:"请输入部门名称",trigger:"blur"}],workingAddress:[{required:!0,message:"请输入工作地址",trigger:"blur"}],position:[{required:!0,message:"请输入职位",trigger:"blur"}]},s=d(!1);f({open:g=>{s.value=!0,l.value={...g}}});const b=V,x=d(),E=async()=>{await x.value.validate();const g=l.value.id;console.log("id",g),await ee(l.value),b("success"),U({type:"success",message:g?"编辑成功":"添加成功"}),s.value=!1};return(g,t)=>{const u=J,m=W,n=X,i=z,y=Q;return v(),S("div",null,[e(y,{modelValue:s.value,"onUpdate:modelValue":t[7]||(t[7]=a=>s.value=a),title:l.value.id?"编辑用户":"添加用户",width:"50%"},{footer:o(()=>[T("div",le,[e(i,{onClick:t[6]||(t[6]=a=>s.value=!1)},{default:o(()=>[h("取消")]),_:1}),e(i,{type:"primary",onClick:E},{default:o(()=>[h("确认")]),_:1})])]),default:o(()=>[e(n,{model:l.value,rules:r,"label-width":"100px",style:{"padding-right":"30px"},ref_key:"formRef",ref:x},{default:o(()=>[e(m,{label:"用户昵称",prop:"nickname"},{default:o(()=>[e(u,{modelValue:l.value.nickname,"onUpdate:modelValue":t[0]||(t[0]=a=>l.value.nickname=a),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1}),e(m,{label:"电话",prop:"phone"},{default:o(()=>[e(u,{modelValue:l.value.phone,"onUpdate:modelValue":t[1]||(t[1]=a=>l.value.phone=a),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1}),e(m,{label:"电子邮箱",prop:"email"},{default:o(()=>[e(u,{modelValue:l.value.email,"onUpdate:modelValue":t[2]||(t[2]=a=>l.value.email=a)},null,8,["modelValue"])]),_:1}),e(m,{label:"部门名称",prop:"companyName"},{default:o(()=>[e(u,{modelValue:l.value.companyName,"onUpdate:modelValue":t[3]||(t[3]=a=>l.value.companyName=a),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1}),e(m,{label:"职位",prop:"position"},{default:o(()=>[e(u,{modelValue:l.value.position,"onUpdate:modelValue":t[4]||(t[4]=a=>l.value.position=a),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1}),e(m,{label:"工作地址",prop:"workingAddress"},{default:o(()=>[e(u,{modelValue:l.value.workingAddress,"onUpdate:modelValue":t[5]||(t[5]=a=>l.value.workingAddress=a),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ve={__name:"index",setup(c){const f=j(),V=d([]),l=d(0),r=d({pageNumber:1,pageSize:5}),s=d(!1),_=async()=>{s.value=!0;const{data:n}=await Z(r.value);V.value=n.records,l.value=n.total,s.value=!1};_();const b=d(),x=()=>{b.value.open({})},E=(n,i)=>{b.value.open(n)},g=async(n,i)=>{await Y.confirm("你确认删除该分类信息吗？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),await ae(n.id),U({type:"success",message:"删除成功"}),_()},t=()=>{_()},u=n=>{r.value.pageNumber=1,r.value.pageSize=n,_()},m=()=>{_()};return(n,i)=>{const y=z,a=F,$=P,A=R,B=G,q=M,D=H;return v(),S("div",null,[e(q,{title:"联络管理"},{extra:o(()=>[k(f).user.username==="admin"?(v(),w(y,{key:0,type:"primary",onClick:x},{default:o(()=>[h(" 新建用户 ")]),_:1})):C("",!0)]),default:o(()=>[I((v(),w(A,{data:V.value,style:{width:"100%"}},{empty:o(()=>[e($,{description:"没有数据"})]),default:o(()=>[e(a,{prop:"id",label:"ID",width:"60"}),e(a,{prop:"nickname",label:"昵称",width:"80"}),e(a,{prop:"phone",label:"电话",width:"120"}),e(a,{prop:"email",label:"电子邮箱"}),e(a,{prop:"companyName",label:"部门名称"}),e(a,{prop:"position",label:"职位"}),e(a,{prop:"workingAddress",label:"工作地址"}),e(a,{label:"操作",width:"150"},{default:o(p=>[k(f).user.username==="admin"?(v(),w(y,{key:0,icon:k(K),circle:"",plain:"",type:"primary",onClick:L=>E(p.row,p.$index)},null,8,["icon","onClick"])):C("",!0),k(f).user.username==="admin"?(v(),w(y,{key:1,icon:k(O),circle:"",plain:"",type:"danger",onClick:L=>g(p.row,p.$index)},null,8,["icon","onClick"])):C("",!0)]),_:1})]),_:1},8,["data"])),[[D,s.value]]),e(B,{"current-page":r.value.pageNumber,"onUpdate:currentPage":i[0]||(i[0]=p=>r.value.pageNumber=p),"page-size":r.value.pageSize,"onUpdate:pageSize":i[1]||(i[1]=p=>r.value.pageSize=p),"page-sizes":[2,3,4,5,10],layout:"jumper, total, sizes, prev, pager, next",background:"",total:l.value,onSizeChange:u,onCurrentChange:m,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1}),e(te,{ref_key:"dialog",ref:b,onSuccess:t},null,512)])}}};export{ve as default};
