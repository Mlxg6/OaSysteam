import{r as i,o as C,c as U,b as e,w as a,g as L,e as _,G as P,j as R,d as z}from"./index-CPZCLJhI.js";import{_ as G,E as H,a as J,b as K,c as O,v as Q}from"./el-table-column-Cw6mIs8X.js";import{E as h}from"./el-input-EJwEnXI7.js";import"./el-popper-CBzjx_xb.js";import{E as S,a as B}from"./el-form-item-CvQ51XjY.js";import{E as N}from"./el-button-aGybSvRj.js";import{t as W,v as X}from"./_plugin-vue_export-helper-C52UWfAG.js";import{g as Y,a as Z,b as ee,c as le}from"./user-IFSiVi_8.js";import{E as ae}from"./el-dialog-DrTM45KF.js";import"./el-overlay-DNljXtA7.js";import{E as T}from"./request-Bo9Nm4OM.js";import{E as te}from"./el-message-box-JObjlNit.js";import"./_initCloneObject-CWwr7yUn.js";const oe={class:"dialog-footer"},ne={__name:"ChannelEdit",emits:["success"],setup($,{expose:f,emit:v}){const l=i({username:"",nickname:"",role:"",password:""}),c={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],role:[{required:!0,message:"请输入角色",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},n=i(!1);f({open:m=>{n.value=!0,l.value={...m}}});const y=v,x=i(),V=async()=>{await x.value.validate();const m=l.value.id;m?(await Y(l.value),y("success")):(await Z(l.value),y("success","add")),T({type:"success",message:m?"编辑成功":"添加成功"}),n.value=!1};return(m,o)=>{const p=h,d=S,k=B,t=N,s=ae;return C(),U("div",null,[e(s,{modelValue:n.value,"onUpdate:modelValue":o[5]||(o[5]=r=>n.value=r),title:l.value.id?"编辑用户":"添加用户",width:"50%"},{footer:a(()=>[L("div",oe,[e(t,{onClick:o[4]||(o[4]=r=>n.value=!1)},{default:a(()=>[_("取消")]),_:1}),e(t,{type:"primary",onClick:V},{default:a(()=>[_("确认")]),_:1})])]),default:a(()=>[e(k,{model:l.value,rules:c,"label-width":"100px",style:{"padding-right":"30px"},ref_key:"formRef",ref:x},{default:a(()=>[e(d,{label:"用户名",prop:"username"},{default:a(()=>[e(p,{modelValue:l.value.username,"onUpdate:modelValue":o[0]||(o[0]=r=>l.value.username=r),minlength:"1",maxlength:"10"},null,8,["modelValue"])]),_:1}),e(d,{label:"用户昵称",prop:"nickname"},{default:a(()=>[e(p,{modelValue:l.value.nickname,"onUpdate:modelValue":o[1]||(o[1]=r=>l.value.nickname=r),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1}),e(d,{label:"角色",prop:"role"},{default:a(()=>[e(p,{modelValue:l.value.role,"onUpdate:modelValue":o[2]||(o[2]=r=>l.value.role=r),minlength:"1",maxlength:"10"},null,8,["modelValue"])]),_:1}),e(d,{label:"密码",prop:"password"},{default:a(()=>[e(p,{modelValue:l.value.password,"onUpdate:modelValue":o[3]||(o[3]=r=>l.value.password=r),minlength:"1",maxlength:"15"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye={__name:"index",setup($){const f=i([]),v=i(0),l=i({pageNumber:1,pageSize:5,username:""}),c=i(!1),n=async()=>{c.value=!0;const{data:t}=await ee(l.value);f.value=t.records,v.value=t.total,c.value=!1};n();const b=i(),y=()=>{b.value.open({})},x=(t,s)=>{console.log(t,s),t.password="",b.value.open(t)},V=async(t,s)=>{console.log(t,s),await te.confirm("你确认删除该分类信息吗？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),await le(t.id),T({type:"success",message:"删除成功"}),n()},m=()=>{console.log(l.value),n()},o=()=>{l.value={pageNumber:1,pageSize:5,username:""}},p=t=>{console.log(t),n()},d=t=>{l.value.pageNumber=1,l.value.pageSize=t,n()},k=()=>{n()};return(t,s)=>{const r=h,w=S,g=N,D=B,E=H,q=J,j=K,I=O,M=G,A=Q;return C(),U("div",null,[e(M,{title:""},{search:a(()=>[e(D,{ref:"form",model:l.value,inline:!0},{default:a(()=>[e(w,{label:"用户名",prop:"username"},{default:a(()=>[e(r,{modelValue:l.value.username,"onUpdate:modelValue":s[0]||(s[0]=u=>l.value.username=u),type:"text",autocomplete:"off",placeholder:"输入用户名查询"},null,8,["modelValue"])]),_:1}),e(w,null,{default:a(()=>[e(g,{type:"info",onClick:o},{default:a(()=>[_("重置")]),_:1}),e(g,{type:"primary",onClick:m},{default:a(()=>[_("搜索")]),_:1})]),_:1})]),_:1},8,["model"])]),extra:a(()=>[e(g,{type:"primary",onClick:y},{default:a(()=>[_(" 新建用户 ")]),_:1})]),default:a(()=>[P((C(),R(j,{data:f.value,style:{width:"100%"}},{empty:a(()=>[e(q,{description:"没有数据"})]),default:a(()=>[e(E,{prop:"username",label:"用户名"}),e(E,{prop:"nickname",label:"昵称"}),e(E,{prop:"role",label:"角色"}),e(E,{label:"操作",width:"200"},{default:a(u=>[e(g,{icon:z(W),circle:"",plain:"",type:"primary",onClick:F=>x(u.row,u.$index)},null,8,["icon","onClick"]),e(g,{icon:z(X),circle:"",plain:"",type:"danger",onClick:F=>V(u.row,u.$index)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[A,c.value]]),e(I,{"current-page":l.value.pageNumber,"onUpdate:currentPage":s[1]||(s[1]=u=>l.value.pageNumber=u),"page-size":l.value.pageSize,"onUpdate:pageSize":s[2]||(s[2]=u=>l.value.pageSize=u),"page-sizes":[2,3,4,5,10],layout:"jumper, total, sizes, prev, pager, next",background:"",total:v.value,onSizeChange:d,onCurrentChange:k,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1}),e(ne,{ref_key:"dialog",ref:b,onSuccess:p},null,512)])}}};export{ye as default};
