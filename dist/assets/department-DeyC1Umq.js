import{r as d,o as x,c as z,b as e,w as o,g as j,e as k,u as M,Y as q,d as C,G as F,j as S,V as L}from"./index-CPZCLJhI.js";import{_ as P,E as R,a as G,b as Y,c as H,v as J}from"./el-table-column-Cw6mIs8X.js";import{E as K}from"./el-input-EJwEnXI7.js";import"./el-popper-CBzjx_xb.js";import{E as B}from"./el-button-aGybSvRj.js";import{t as O,v as Q}from"./_plugin-vue_export-helper-C52UWfAG.js";import{i as V,E as N}from"./request-Bo9Nm4OM.js";import{E as W}from"./el-dialog-DrTM45KF.js";import"./el-overlay-DNljXtA7.js";import{E as X,a as Z}from"./el-form-item-CvQ51XjY.js";import{E as ee}from"./el-message-box-JObjlNit.js";import"./_initCloneObject-CWwr7yUn.js";const te=r=>V({url:"department/page",method:"get",params:r}),ne=r=>V({url:"department/save",method:"post",data:r}),h=r=>V({url:"department/save",method:"post",data:r}),ae=r=>V.delete("/department/+".concat(r)),oe={class:"dialog-footer"},le={__name:"ChannelEdit",emits:["success"],setup(r,{expose:b,emit:y}){const t=d({title:"",content:""}),u={title:[{required:!0,message:"请输入内容",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},i=d(!1);b({open:m=>{i.value=!0,t.value={...m}}});const g=y,E=d(),w=async()=>{await E.value.validate();const m=t.value.id;console.log("id",m),console.log(t.value),await h(t.value),m?await h(t.value):await ne(t.value),g("success"),N({type:"success",message:m?"编辑成功":"添加成功"}),i.value=!1};return(m,l)=>{const _=K,f=X,n=Z,s=B,v=W;return x(),z("div",null,[e(v,{modelValue:i.value,"onUpdate:modelValue":l[4]||(l[4]=a=>i.value=a),title:t.value.id?"编辑":"添加",width:"50%"},{footer:o(()=>[j("div",oe,[e(s,{onClick:l[3]||(l[3]=a=>i.value=!1)},{default:o(()=>[k("取消")]),_:1}),e(s,{type:"primary",onClick:w},{default:o(()=>[k("确认")]),_:1})])]),default:o(()=>[e(n,{model:t.value,rules:u,"label-width":"100px",style:{"padding-right":"30px"},ref_key:"formRef",ref:E},{default:o(()=>[e(f,{label:"名称",prop:"dname"},{default:o(()=>[e(_,{modelValue:t.value.dname,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.dname=a),minlength:"1",maxlength:"10"},null,8,["modelValue"])]),_:1}),e(f,{label:"电话号码",prop:"member"},{default:o(()=>[e(_,{modelValue:t.value.member,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.member=a),minlength:"1",maxlength:"20"},null,8,["modelValue"])]),_:1}),e(f,{label:"办公地点",prop:"position"},{default:o(()=>[e(_,{modelValue:t.value.position,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.position=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},be={__name:"department",setup(r){const b=M(),y=d([]),t=d(0),u=d({pageNumber:1,pageSize:5}),i=d(!1),c=async()=>{i.value=!0;const{data:n}=await te(u.value);y.value=n.records,t.value=n.total,i.value=!1};c();const g=d(),E=()=>{g.value.open({})},w=(n,s)=>{console.log(n,s),g.value.open(n)},m=async(n,s)=>{console.log(n,s),await ee.confirm("你确认删除？","温馨提示",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),await ae(n.id),N({type:"success",message:"删除成功"}),c()},l=n=>{console.log(n),c()},_=n=>{u.value.pageNumber=1,u.value.pageSize=n,c()},f=()=>{c()};return(n,s)=>{const v=B,a=R,U=G,$=Y,A=H,D=P,T=J;return x(),z("div",null,[e(D,{title:"部门管理"},q({default:o(()=>[F((x(),S($,{data:y.value,style:{width:"100%"}},{empty:o(()=>[e(U,{description:"没有数据"})]),default:o(()=>[e(a,{prop:"id",label:"ID",width:"60"}),e(a,{prop:"dname",label:"名称"}),e(a,{prop:"member",label:"电话"}),e(a,{prop:"position",label:"工作地点"}),C(b).user.username==="admin"?(x(),S(a,{key:0,label:"操作",width:"150"},{default:o(p=>[e(v,{icon:C(O),circle:"",plain:"",type:"primary",onClick:I=>w(p.row,p.$index)},null,8,["icon","onClick"]),e(v,{icon:C(Q),circle:"",plain:"",type:"danger",onClick:I=>m(p.row,p.$index)},null,8,["icon","onClick"])]),_:1})):L("",!0)]),_:1},8,["data"])),[[T,i.value]]),e(A,{"current-page":u.value.pageNumber,"onUpdate:currentPage":s[0]||(s[0]=p=>u.value.pageNumber=p),"page-size":u.value.pageSize,"onUpdate:pageSize":s[1]||(s[1]=p=>u.value.pageSize=p),"page-sizes":[2,3,4,5,10],layout:"jumper, total, sizes, prev, pager, next",background:"",total:t.value,onSizeChange:_,onCurrentChange:f,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:2},[C(b).user.username==="admin"?{name:"extra",fn:o(()=>[e(v,{type:"primary",onClick:E},{default:o(()=>[k(" 新增部门 ")]),_:1})]),key:"0"}:void 0]),1024),e(le,{ref_key:"dialog",ref:g,onSuccess:l},null,512)])}}};export{be as default};
